# 字符串和正则表达式&&快速响应的用户界面

标签（空格分隔）： 高性能JavaScript

---

# 字符串和正则表达式
## (+)和(+=)操作符
连接字符串`str += "one" + "two"`的步骤：
1.在内存中创建一个临时字符串
2.连接后的字符串"onetwo"被赋值到该临时字符串
3.临时字符串和与str当前值连接
4.结果赋值给str

基础字符串位于最左端的位置，可以避免重复拷贝一个逐渐变大的基础字符串。当连接数量巨大的字符串时，数组项合并是位移在IE7及更早版本中性能合理的方法。
如果不考虑IE7及更早版本，数组项合并是最慢的字符串连接方法之一。推荐使用"+"和"+=",避免不必要的中间字符串。

## 正则表达式工作原理
- 编译：验证表达式，生成原生代码程序
- 设置起始位置
- 匹配每个正则表达式字元：失败会试着回溯到之前尝试匹配的位置，然后尝试其他可能路径
- 匹配成功或失败： 当前的位置发了完全匹配则宣布匹配成功，否则回退第二步从下一个字符重新尝试
# 快速响应的用户界面
浏览器UI线程：用于执行JavaScript和更新用户界面的进程。
JavaScript和用户界面更新在同一个进程中运行，因此一次只能处理一件事情。这意味着当JavaScript运行时，用户界面不能响应输入，反之亦然。
## 浏览器限制
此类限制分为两种：调用栈大小限制和长时间运行脚本限制。

记录脚本运行时间有两种方法：
- 记录脚本开始以来执行的语句数量
- 记录脚本执行的总时长
单个JavaScript操作花费的总时间不应该超过100毫秒。
## 定时器
定时器可用来安排代码延迟执行，把长时间运行脚本分解成一系列的小任务。
无论发生何种情况，创建一个定时器会造成UI线程暂停，如同它从一个任务切换到下一个任务。因此定时器代码会重置所有相关的浏览器的限制，包括长时间运行脚本定时器。调用栈也在定时器的代码中重置为0。这一特性使得定时器成为长时间运行JavaScript代码理想的跨浏览器解决方案。

## Web Workers 
Web workers是新版浏览器支持的特性，它允许在UI线程外部执行JavaScript代码，从而避免锁定UI。
Web Workers从外部线程中修改DOM会导致用户界面出现错误，每个Web Worker都有自己的全局运行环境。





